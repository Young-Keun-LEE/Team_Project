{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/custom_design_list.css') }}">
{% endblock %}

{% block content %}
    <div class="main-header">
        <h2>{{ title }}</h2>
    </div>
    <hr class="main-divider">

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
            <br>
        {% endif %}
    {% endwith %}

    <div class="design-gallery" data-set-active-url="{{ url_for('custom.set_active_design') }}">
        {% for design in all_designs %}
            
            {% set is_owned = design.id in owned_design_ids %}
            {% set is_active = design.id == active_design_id %}

            <div class="design-card {{ 'owned' if is_owned else 'locked' }} {{ 'active' if is_active else '' }}">
                <div class="thumbnail-placeholder">
                    <img src="{{ design.thumbnail_url | default(url_for('static', filename='images/placeholder.png'), true) }}" alt="{{ design.name }}">
                </div>
                <h3>{{ design.name }}</h3>
                <p>{{ design.description }}</p>

                <div class="card-footer">
                    {% if is_owned %}
                        {% if is_active %}
                            <button class="design-button active" disabled>âœ”ï¸ ì ìš©ë¨</button>
                        {% else %}
                            <button class="design-button apply-btn" data-design-id="{{ design.id }}">ì ìš©í•˜ê¸°</button>
                        {% endif %}
                    {% else %}
                        <span class="lock-icon">ğŸ”’ ì ê¹€</span>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}

{% block extra_js %}
  <script src="{{ url_for('static', filename='js/custom_design.js') }}"></script>
{% endblock %}